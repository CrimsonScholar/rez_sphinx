<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Batch-Publish Documentation &mdash; rez_sphinx 1.0.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Linking rez_sphinx With Other Documentation Tools" href="linking_rez_sphinx_with_other_documentation_tools.html" />
    <link rel="prev" title="rez_sphinx As A Release Hook" href="rez_sphinx_as_a_release_hook.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> rez_sphinx
          </a>
              <div class="version">
                1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="user_documentation.html">User Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="user_documentation.html#beginner-topics">Beginner Topics</a></li>
<li class="toctree-l2"><a class="reference internal" href="user_documentation.html#all-commands">All Commands</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="user_documentation.html#advanced-topics">Advanced Topics</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="using_sphinx_rtd_theme.html">Using sphinx-rtd-theme</a></li>
<li class="toctree-l3"><a class="reference internal" href="adding_extra_interlinking.html">Adding Extra Interlinking</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuring_rez_sphinx.html">Configuring rez_sphinx</a></li>
<li class="toctree-l3"><a class="reference internal" href="auto_append_help_tags.html">Adding Documentation Automatically</a></li>
<li class="toctree-l3"><a class="reference internal" href="enable_external_website_publishing.html">Enabling External Website Publishing</a></li>
<li class="toctree-l3"><a class="reference internal" href="enabling_rez_help_integration.html">Enabling rez-help Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="rez_sphinx_as_a_release_hook.html">rez_sphinx As A Release Hook</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Batch-Publish Documentation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#when-you-re-ready-to-release">When You’re Ready To Release</a></li>
<li class="toctree-l4"><a class="reference internal" href="#why-this-script-works">Why This Script Works</a></li>
<li class="toctree-l4"><a class="reference internal" href="#after-releasing">After releasing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="linking_rez_sphinx_with_other_documentation_tools.html">Linking rez_sphinx With Other Documentation Tools</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="developer_documentation.html">Developer Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/modules.html">API Documentation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">rez_sphinx</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="user_documentation.html">User Documentation</a> &raquo;</li>
      <li>Batch-Publish Documentation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/batch_publish_documentation.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="batch-publish-documentation">
<h1>Batch-Publish Documentation<a class="headerlink" href="#batch-publish-documentation" title="Permalink to this headline"></a></h1>
<p>If you want to add documentation in-batch, the steps are very similar to
<a class="reference internal" href="getting_started.html"><span class="doc">Getting Started</span></a>, with some adjustments.</p>
<ul>
<li><p>cd to the root of some git repository containing <strong>source</strong> Rez packages</p></li>
<li><p>Make a <code class="docutils literal notranslate"><span class="pre">rez-env</span></code> containing these packages</p>
<blockquote>
<div><ul class="simple">
<li><p>rez_sphinx</p></li>
<li><p>rez_inspect</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Run this in the terminal:</p></li>
</ul>
<p>TODO : double-check that this script works</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>You’ll need to build and include rez-inspect, which is a Rez package
located in this repository.</p>
</div>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># add_rez_sphinx.sh</span>
<span class="c1">#!/usr/bin/env sh</span>

<span class="nb">set</span> -e  <span class="c1"># Stop execution on the first error. This is optional</span>

<span class="nb">export</span> <span class="nv">REZ_SPHINX_INIT_OPTIONS_CHECK_DEFAULT_FILES</span><span class="o">=</span><span class="m">0</span>

<span class="nv">message</span><span class="o">=</span><span class="s2">&quot;Added rez_sphinx documentation&quot;</span>
<span class="nv">directories</span><span class="o">=</span><span class="sb">`</span>rez_sphinx suggest build-order . --search-mode <span class="nb">source</span> --display-as directories --filter already_released<span class="sb">`</span>
<span class="nv">root</span><span class="o">=</span><span class="sb">`</span>git rev-parse --show-toplevel<span class="sb">`</span>
<span class="nv">branch</span><span class="o">=</span>features/adding_rez_sphinx

<span class="nb">cd</span> <span class="nv">$root</span>

<span class="k">if</span> <span class="o">[</span> <span class="s2">&quot;`git branch --show-current`&quot;</span> !<span class="o">=</span> <span class="s2">&quot;</span><span class="nv">$branch</span><span class="s2">&quot;</span> <span class="o">]</span>
<span class="k">then</span>
    <span class="k">if</span> <span class="o">[</span> <span class="sb">`</span>git branch --list <span class="nv">$branch</span><span class="sb">`</span> <span class="o">]</span>
    <span class="k">then</span>
        git checkout <span class="nv">$branch</span>
    <span class="k">else</span>
        git checkout -b <span class="nv">$branch</span>
    <span class="k">fi</span>
<span class="k">fi</span>

<span class="k">for</span> directory <span class="k">in</span> <span class="nv">$directories</span>
<span class="k">do</span>
    <span class="nb">cd</span> <span class="nv">$directory</span>

    rez-build --clean --install
    <span class="nv">package_name</span><span class="o">=</span><span class="sb">`</span>rez-inspect name --style<span class="o">=</span>pretty<span class="sb">`</span>
    <span class="nv">package_version</span><span class="o">=</span><span class="sb">`</span>rez-inspect version --style<span class="o">=</span>pretty<span class="sb">`</span>
    rez-env <span class="s2">&quot;</span><span class="nv">$package_name</span><span class="s2">==</span><span class="nv">$package_version</span><span class="s2">&quot;</span> rez_sphinx -- rez_sphinx init --skip-existing
    git add --all .
    git commit -m <span class="nv">$message</span>

    <span class="c1"># You can uncomment the line below if you already have the release_hook set up</span>
    <span class="c1"># git push -u origin $branch &amp;&amp; rez-release -m $message</span>
<span class="k">done</span>

git push -u origin <span class="nv">$branch</span>
</pre></div>
</div>
<p>The jist of the script is, cd to every Rez package, run <code class="docutils literal notranslate"><span class="pre">rez_sphinx</span> <span class="pre">init</span></code> and
push the branch. Assuming you followed <a class="reference internal" href="rez_sphinx_as_a_release_hook.html"><span class="doc">rez_sphinx As A Release Hook</span></a>, the
next time any of those packages are released via <a class="reference external" href="https://github.com/nerdvegas/rez/wiki/Command-Line-Tools#rez-release">rez-release</a>, you’ll have
beautiful documentation waiting for you. The script assumes you want to place
your changes under a new feature branch called <code class="docutils literal notranslate"><span class="pre">features/adding_rez_sphinx</span></code>
so you can make PR(s) as needed. There’s the option to run this all in the
master branch too, if you want but exercise common sense and don’t do that
without prior approval.</p>
<section id="when-you-re-ready-to-release">
<h2>When You’re Ready To Release<a class="headerlink" href="#when-you-re-ready-to-release" title="Permalink to this headline"></a></h2>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>If you want auto-linking, auto-publishing, and the like to work, you must
opt-in to those features before following this tutorial.</p>
<p>Follow the steps in <a class="reference internal" href="rez_sphinx_as_a_release_hook.html"><span class="doc">rez_sphinx As A Release Hook</span></a> first before continuing.</p>
</div>
<p>Assuming you go through PR, everything’s merged into master, and you’re ready
to release. This script will automate that.</p>
<p>TODO : double-check that this script works</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">REZ_SPHINX_INIT_OPTIONS_CHECK_DEFAULT_FILES</span><span class="o">=</span><span class="m">0</span>

<span class="nv">message</span><span class="o">=</span><span class="s2">&quot;Added rez_sphinx documentation&quot;</span>
<span class="nv">directories</span><span class="o">=</span><span class="sb">`</span>rez_sphinx suggest build-order . --search-mode <span class="nb">source</span> --display-as directories --filter already_released<span class="sb">`</span>

<span class="nv">root</span><span class="o">=</span><span class="sb">`</span>git rev-parse --show-toplevel<span class="sb">`</span>
<span class="nb">cd</span> <span class="nv">$root</span>

<span class="k">for</span> directory <span class="k">in</span> <span class="nv">$directories</span>
<span class="k">do</span>
    <span class="nb">cd</span> <span class="nv">$directory</span>
    rez-release -m <span class="nv">$message</span>
<span class="k">done</span>
</pre></div>
</div>
</section>
<section id="why-this-script-works">
<h2>Why This Script Works<a class="headerlink" href="#why-this-script-works" title="Permalink to this headline"></a></h2>
<p>The long command at the start, <code class="docutils literal notranslate"><span class="pre">rez_sphinx</span> <span class="pre">suggest</span> <span class="pre">build-order</span> <span class="pre">.</span> <span class="pre">etc</span> <span class="pre">etc</span> <span class="pre">etc</span></code>
determines</p>
<ul class="simple">
<li><p>Does the package need documentation</p></li>
<li><p>Is the Rez package already released with documentation</p></li>
</ul>
<p>If either condition is False, the package’s path is returned.</p>
<p>Then during the for-loop, <code class="docutils literal notranslate"><span class="pre">rez_sphinx</span> <span class="pre">init</span> <span class="pre">--skip-existing</span></code> stops early if it
sees documentation (rez_sphinx documentation or not). If it doesn’t have
documentation, it’s added. From there, you have the option to just push /
release / etc.</p>
</section>
<section id="after-releasing">
<h2>After releasing<a class="headerlink" href="#after-releasing" title="Permalink to this headline"></a></h2>
<p><strong>Important</strong>: Whenever you choose to batch- <a class="reference external" href="https://github.com/nerdvegas/rez/wiki/Command-Line-Tools#rez-release">rez-release</a>, remember that you
did it with <code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">REZ_SPHINX_INIT_OPTIONS_CHECK_DEFAULT_FILES=0</span></code>. Assuming
you haven’t changed your default configuration to <a class="reference internal" href="configuring_rez_sphinx.html#rez-sphinx-init-options-check-default-files"><span class="std std-ref">always ignore default
files</span></a> (which by the way is
<strong>not</strong> recommended), that means the default files are still unedited. Make
sure to tell maintainers to <strong>add hand-written documentation</strong> to the default
files, “developer_documentation.rst” and “user_documentation.rst”, so that
future <a class="reference external" href="https://github.com/nerdvegas/rez/wiki/Command-Line-Tools#rez-release">rez-release</a> don’t error on them!</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="rez_sphinx_as_a_release_hook.html" class="btn btn-neutral float-left" title="rez_sphinx As A Release Hook" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="linking_rez_sphinx_with_other_documentation_tools.html" class="btn btn-neutral float-right" title="Linking rez_sphinx With Other Documentation Tools" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, ColinKennedy.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>